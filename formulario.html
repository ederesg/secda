<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container mt-5">
        <div class="card">
            <div class="card-header text-center">
                <h2>Formulário de Cadastro</h2>
            </div>
            <div class="card-body">
                <form id="data-form">
                    <div class="form-group">
                        <label for="prioridade">Prioridade</label>
                        <input type="text" class="form-control" id="prioridade" required>
                    </div>
                    <div class="form-group">
                        <label for="item">Item</label>
                        <input type="text" class="form-control" id="item" required>
                    </div>
                    <div class="form-group">
                        <label for="descricao">Descrição</label>
                        <input type="text" class="form-control" id="descricao" required>
                    </div>
                    <div class="form-group">
                        <label for="quantidade">Quantidade</label>
                        <input type="number" class="form-control" id="quantidade" required>
                    </div>
                    <div class="form-group">
                        <label for="valor">Valor</label>
                        <input type="number" class="form-control" id="valor" required>
                    </div>
                    <div class="form-group">
                        <label for="natureza">Natureza</label>
                        <input type="text" class="form-control" id="natureza" required>
                    </div>
                    <div class="form-group">
                        <label for="secao_centralizador">Seção Centralizador</label>
                        <input type="text" class="form-control" id="secao_centralizador" required>
                    </div>
                    <div class="form-group">
                        <label for="email_centralizador">Email Centralizador</label>
                        <input type="email" class="form-control" id="email_centralizador" required>
                    </div>
                    <div class="form-group">
                        <label for="secao_cliente">Seção Cliente</label>
                        <input type="text" class="form-control" id="secao_cliente" required>
                    </div>
                    <div class="form-group">
                        <label for="email_cliente">Email Cliente</label>
                        <input type="email" class="form-control" id="email_cliente" required>
                    </div>
                    <div class="form-group">
                        <label for="justificativa">Justificativa</label>
                        <input type="text" class="form-control" id="justificativa" required>
                    </div>
                    <div class="form-group">
                        <label for="status">Status</label>
                        <input type="text" class="form-control" id="status" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Enviar</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.getElementById("data-form").addEventListener("submit", function(event) {
            event.preventDefault();
            const formData = {
                prioridade: document.getElementById("prioridade").value,
                item: document.getElementById("item").value,
                descricao: document.getElementById("descricao").value,
                quantidade: document.getElementById("quantidade").value,
                valor: document.getElementById("valor").value,
                natureza: document.getElementById("natureza").value,
                secao_centralizador: document.getElementById("secao_centralizador").value,
                email_centralizador: document.getElementById("email_centralizador").value,
                secao_cliente: document.getElementById("secao_cliente").value,
                email_cliente: document.getElementById("email_cliente").value,
                justificativa: document.getElementById("justificativa").value,
                status: document.getElementById("status").value
            };

            // Envia os dados para a planilha
            fetch("https://script.google.com/macros/s/AKfycbzMzWOGSbfinMz_-_863yJfrvmiLyXuclXviGzQXl8yYnUK1C-WRsapcKqUFYEFddD6/exec", {
                method: "POST",
                body: JSON.stringify(formData),
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                if (data.status === "success") {
                    alert("Dados enviados com sucesso!");
                    // Limpa todos os campos
                    document.getElementById("data-form").reset();
                }
            })
            .catch(error => console.error("Erro:", error));
        });
    </script>
</body>
</html>
